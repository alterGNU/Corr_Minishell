# ============================================================================================================
# TESTS AFFECTATIONS AND EXPANSION
# ============================================================================================================
echo return=[$?]
echo "TESTS 1:SIMPLE AND MULTIPLE VALID AFFECTATION"
v1="toto"
echo return=[$?]
v2="tata" v3="$v1 $v2" v4=
echo return=[$?]
echo "\$v1=$v1" '$v2='$v2 \$v3=$v3"but \$v4=<$v4>-->empty"
echo return=[$?]
# ============================================================================================================
echo 
echo "TESTS 2:UN-VALID AFFECTATION"
1v="wrong name"
echo return=[$?]
="no name"
echo return=[$?]
v2="new1" v3="new2" v.4="wrong name too"
echo return=[$?]
echo "\$v1=$v1" '$v2='$v2 \$v3=$v3"but \$v4=<$v4>-->empty"
echo return=[$?]
# ============================================================================================================
echo 
echo "TESTS 3:UNKNOWN AND EMPTY VAR AS CMD"
$unknown_var
echo return=[$?]
v0=""
$v0
echo return=[$?]
v1="              "
$v1
echo return=[$?]
#v2="				"
#$v2
#echo return=[$?]
#v3="	    		       "
#$v3
#echo return=[$?]
echo before unset v0=$v0, v1=$v1,v2=$v2,v3=$v3.
unset v0 v1 v2 v3
echo after unset v0=$v0, v1=$v1,v2=$v2,v3=$v3.
# ============================================================================================================
echo 
echo "TESTS 4:UNKNOWN AND EMPTY VAR AS CMD"
#v0="	    		    	echo 	   "
#v1="   	petite		perruche	   "
#$v0
#echo return=[$?]
#$v0 coucou
#echo return=[$?]
#$v0 coucou $v1
#echo return=[$?]
v2="       echo    "
v3="   petite   perruche   "
$v2
echo return=[$?]
$v2 coucou
echo return=[$?]
$v2 coucou $v3
echo return=[$?]
echo before unset v2=$v2, v3=$v3.
unset v0 v3
echo after unset v2=$v2, v3=$v3.
# ============================================================================================================
echo 
echo "TESTS 5:WORST CASE SCENARIO FOR EXPAND"
super="$sldkfjlskdjf $sdkfjlsdkjf    echo      titi  $sldkfj"
arg1="$sldkf to $sdlkf to $sldflskf"
$sdlfkjsldj $sdlkfjlskdjfk $super $sdlfkjsldjf $arg1 $sdlfjslkdf tutu $sldkfjlskdfj
unset super arg1
# ============================================================================================================
echo 
echo "TESTS 6:AFFECTATION IN PIPE-->NO AFFECTATION"
echo '$> echo toto|a=b b=c c=d|echo tata && echo a=$a, b=$b, c=$c. || echo FAIL'
echo toto|a=b b=c c=d|echo tata && echo a=$a, b=$b, c=$c. || echo FAIL
unset a b c
echo
echo '$> a=b b=c c=d | echo tata | cat && echo a=$a, b=$b, c=$c. || echo FAIL'
a=b b=c c=d | echo tata | cat && echo a=$a, b=$b, c=$c. || echo FAIL
unset a b c
echo
echo '$> echo tata|cat|a=b b=c c=d && echo a=$a, b=$b, c=$c. || echo FAIL'
echo tata|cat|a=b b=c c=d && echo a=$a, b=$b, c=$c. || echo FAIL
unset a b c
echo
echo '$> a=b|b=c c=d|echo tata && echo a=$a, b=$b, c=$c. || echo FAIL'
a=b|b=c c=d|echo tata && echo a=$a, b=$b, c=$c. || echo FAIL
unset a b c
echo
echo '$> a=b|b=c|c=d && echo a=$a, b=$b, c=$c. || echo FAIL'
a=b|b=c|c=d && echo a=$a, b=$b, c=$c. || echo FAIL
unset a b c
echo
echo '$> a=b|b=c c=d|qwerty && echo FAIL || echo a=$a, b=$b, c=$c.'
a=b|b=c c=d|qwerty && echo FAIL || echo a=$a, b=$b, c=$c.
unset a b c
echo
# ============================================================================================================
echo 
echo "TESTS 7:PROTECTED VAR-ENV AFFECTATION"
echo "-[ UNDERSCORE PROTECTION ]-----------------------------------------------------------------------------"
_1=v1 _2=v2 v_3=v3
echo "_1=$_1 _2=$_2 v_3=$v_3"
unset _1 _2 v_3
env | grep ^_
echo "BEFORE UNDERSCORE=$_"
_="new_value"
env | grep ^_
echo "AFTER UNDERSCORE=$_"
echo "-[ PID DOLLAR PROTECTION ]-----------------------------------------------------------------------------"
$=42
echo "-[ PID DOLLAR PROTECTION ]-----------------------------------------------------------------------------"
?=42
